import hashlib
import requests

def get_file_hash(file_path):
    sha256_hash = hashlib.sha256()
    with open(file_path, "rb") as f:
        for byte_block in iter(lambda: f.read(4096), b""):
            sha256_hash.update(byte_block)
    return sha256_hash.hexdigest()

def check_virustotal(file_hash, api_key):
    url = f"https://www.virustotal.com/vtapi/v2/file/report?apikey={api_key}&resource={file_hash}"
    response = requests.get(url)
    return response.json()

if __name__ == "__main__":
    file_path = input("Enter the file path: ")
    api_key = input("Enter your VirusTotal API key: ")
    file_hash = get_file_hash(file_path)
    report = check_virustotal(file_hash, api_key)
    print(f"VirusTotal report: {report}")

